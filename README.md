# Консольный менеджер личных финансов

Java-приложение для учёта доходов и расходов без внешней БД. Все данные лежат в файлах `data/users.dat` и `data/wallets/<login>-wallet.dat`, загружаются при авторизации и автоматически сохраняются после каждой операции. Проект построен на Java 17, собирается через Maven, покрыт unit‑тестами и проверяется GitHub Actions.

## Основные функции
- регистрация и авторизация нескольких пользователей (SHA‑256 для паролей);
- добавление доходов/расходов, комментарии и произвольные категории;
- бюджеты по категориям (регистр игнорируется), предупреждения на 80 % лимита и при перерасходе;
- отчёты: общий summary, статистика по категориям, последние операции, экспорт в файл;
- команда `category-summary` принимает несколько категорий и уведомляет, если данные отсутствуют;
- переводы между кошельками пользователей с автоматическим отражением расхода/дохода;
- переименование категорий (`rename-category`) с переносом бюджета и операций;
- импорт операций из CSV/TSV (`import-transactions`);
- уведомления при превышении расходов над доходами и при нулевом балансе.

## Требования и запуск
1. Установите JDK 17+ и Maven.
2. Выполните:
   ```bash
   mvn clean package
   java -cp target/financeapp-1.0.0.jar financeapp.Main
   ```
3. Для прогонки тестов и Checkstyle достаточно `mvn verify`.

## CLI-приглашение
После входа отображается `[login]>`. Команды на английском для краткости.

| Команда              | Описание |
|---------------------|----------|
| `help`              | список команд и подсказок |
| `add-income`        | добавить доход (категория, сумма, комментарий) |
| `add-expense`       | добавить расход с проверкой бюджета |
| `set-budget`        | установить/обновить бюджет категории |
| `show-summary`      | суммарный отчёт по кошельку |
| `view-budgets`      | все бюджеты и остатки |
| `list-transactions` | журнал операций |
| `category-summary`  | расчёт по выбранным категориям |
| `export-summary`    | экспорт отчёта в текстовый файл |
| `import-transactions` | загрузка CSV/TSV (`type,category,amount[,note]`) |
| `transfer`          | перевести средства другому пользователю |
| `rename-category`   | переименовать категорию во всех операциях и бюджетах |
| `save`              | сохранить кошелёк вручную |
| `logout` / `exit`   | выход из аккаунта / сохранение и завершение программы |

## Импорт CSV/TSV
Файл должен содержать минимум три столбца `type,category,amount`. Разделитель `,` или `;`, значения в кавычках поддерживаются. Допустимые типы — `INCOME` или `EXPENSE`. Ошибки указывают номер строки и причину (например, неверная сумма).

## Архитектура
- `financeapp.app.Application` — CLI-цикл, команды, подсказки, уведомления.
- `financeapp.auth` — регистрация, хранилище пользователей, хэширование паролей.
- `financeapp.model` — `Wallet`, `Transaction`, `TransactionType`. `Wallet` хранит операции, бюджеты и умеет переименовывать категории.
- `financeapp.persistence.WalletStore` — интерфейс хранилища кошельков (используется файловая реализация `FileWalletStore`).
- `financeapp.service`
  - `WalletService` — операции, бюджеты, расчёты и остатки;
  - `TransferService` — переводы и фиксация операций у обеих сторон;
  - `FinanceReportService` — отчёты и экспорт;
  - `TransactionImportService` — импорт CSV/TSV и валидация данных.
- `src/test/java` — unit‑тесты + `InMemoryWalletStore` для подмены стораджа.

## Тестирование и CI
- 15 unit‑тестов JUnit 5 (`Wallet`, `WalletService`, `TransferService`, `FinanceReportService`, `TransactionImportService`).
- Команда `mvn verify` запускает компиляцию, тесты и Checkstyle.
- GitHub Actions (`.github/workflows/ci.yml`) автоматически выполняет `mvn verify` при push/PR.

## Соответствие критериям
- **Авторизация, CLI-цикл, операции, кошельки** — реализованы в полном объёме.
- **Категории, бюджеты, отчёты, уведомления** — бюджеты по категориям, остатки, предупреждения на 80 % и при перерасходе, вывод сумм по категориям.
- **Сохранение данных** — кошелёк загружается при входе, сохраняется после каждой операции и при выходе.
- **Валидация** — проверяются логины/пароли, суммы, пустые строки, существование категорий, корректность CSV.
- **Архитектура** — разделение на слои (CLI / сервисы / модель / хранилище), интерфейс `WalletStore`.
- **Средний уровень** — подсчёты по нескольким категориям, редактирование бюджетов, экспорт и импорт отчётов, расширенные уведомления, удобный `help`.
- **Высокий уровень** — unit‑тесты, Maven + Checkstyle, GitHub Actions, подробная документация по использованию и архитектуре.

## Быстрый smoke-тест
```powershell
$input = @('2','demo','password','1','demo','password','exit') -join "`n"
$input += "`n"
$input | java -cp target/financeapp-1.0.0.jar financeapp.Main
```
Сценарий регистрирует пользователя `demo`, выполняет вход и завершается, проверяя жизненный цикл приложения.

